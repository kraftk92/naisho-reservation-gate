<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reservation Access</title>

<style>
  body { font-family: Arial, sans-serif; background: #f8f8f8; padding: 40px; }
  #login { max-width: 300px; margin: auto; }
  #widget { display: none; margin-top: 30px; }
  input { width: 100%; padding: 10px; margin-top: 10px; }
  button { width: 100%; padding: 10px; margin-top: 10px; background: black; color: white; cursor: pointer; }
  #error { color: red; margin-top: 10px; }
</style>

</head>
<body>

<div id="login">
  <h2>Enter Password to Continue</h2>
  <input id="passwordInput" type="password" placeholder="Password">
  <button onclick="checkPassword()">Submit</button>
  <div id="error"></div>
</div>

<div id="widget"></div>

<script>
// Use your working URL including the ?key=SECRET
const appsScriptURL = "YOUR_WORKING_APPS_SCRIPT_URL";

let remotePassword = null;

// Fetch password from Apps Script backend
async function loadPassword() {
  try {
    const response = await fetch(appsScriptURL);
    const data = await response.json();
    if (data.password) {
      remotePassword = data.password.trim();
    } else {
      document.getElementById("error").textContent = "System error. Try again.";
    }
  } catch (err) {
    console.error("Error fetching password:", err);
    document.getElementById("error").textContent = "System error.";
  }
}

// Validate password
function checkPassword() {
  if (!remotePassword) {
    document.getElementById("error").textContent = "Still loading. Try again in a moment.";
    return;
  }

  const userInput = document.getElementById("passwordInput").value.trim();

  if (userInput === remotePassword) {
    document.getElementById("login").style.display = "none";
    loadWidget();
  } else {
    document.getElementById("error").textContent = "Incorrect password.";
  }
}

// Load widget only after password match
function loadWidget() {
  const widgetHTML = `
    <iframe 
      src="https://www.opentable.com/widget/reservation/mural?rid=1413745&type=standard&color=8&dark=false&iframe=true" 
      width="288" height="490" frameborder="0" scrolling="no">
    </iframe>
  `;
  document.getElementById("widget").innerHTML = widgetHTML;
  document.getElementById("widget").style.display = "block";
}

// Load password on startup
loadPassword();
</script>

</body>
</html>
